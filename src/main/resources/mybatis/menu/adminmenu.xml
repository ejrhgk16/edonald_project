<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edonald.hadmin.dao.AdminMenuMapper">
	<select id="getMenu" resultType="com.edonald.hadmin.dto.MenuDto">
		SELECT * FROM menu WHERE seq = #{seq}
	</select>
	<select id="listAll" resultType="com.edonald.hadmin.dto.MenuDto">
		SELECT * FROM menu m WHERE type = #{type} ORDER BY status DESC,category_code,seq ASC
	</select>
	<update id="updateStatus">
		UPDATE menu SET status = #{status} WHERE seq = #{seq}
	</update>
	<insert id="insert">
		INSERT INTO menu VALUES(
			#{name},
			#{kcal},
			#{img_path},
			#{set_img_path},
			#{status},
			#{category_code},
			#{price},
			#{allergy},
			NULL,
			#{type},0,0,0,0,0
			<choose>
				<when test="l_price != 0">,#{l_price}</when>
				<otherwise>,null</otherwise>
			</choose>
			<choose>
				<when test="s_price != 0">,#{s_price}</when>
				<otherwise>,null</otherwise>
			</choose>
			) 
			
	</insert>
	<update id="update">
		UPDATE menu SET 
			name = #{name},
			kcal = #{kcal},
			<if test="img_path != null">img_path = #{img_path},</if>
			<if test="set_img_path != null">set_img_path = #{set_img_path},</if>
			<if test="s_price != 0">s_price = #{s_price},</if>
			<if test="l_price != 0">l_price = #{l_price},</if>
			category_code = #{category_code},
			price = #{price},
			allergy = #{allergy},
			type = #{type} 
		WHERE seq = #{seq}
	</update>
	<update id="updateSubstitue">
		UPDATE menu SET
			sub_to = #{sub_to},
			sub_pl = #{sub_pl},
			sub_ls = #{sub_ls},
			sub_s = #{sub_s},
			sub_em = #{sub_em}
		WHERE seq = #{seq}
	</update>
</mapper>